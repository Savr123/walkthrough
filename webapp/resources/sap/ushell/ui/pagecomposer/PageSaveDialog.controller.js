// Copyright (c) 2009-2017 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/model/json/JSONModel","sap/ushell/resources","sap/ui/thirdparty/jquery"],function(J,r,q){"use strict";function g(){return sap.ui.getCore().byId("sapUshellPageSaveDialog");}return{_closeDialog:function(){g().close();},onSave:function(){var f=g();var m=f.getModel();var R={content:{id:m.getProperty("/id"),title:m.getProperty("/title"),description:m.getProperty("/description")},metadata:{}};delete this._rejectSavePagePromise;this._resolveSavePagePromise(R);this._closeDialog();},onCancel:function(){this._rejectSavePagePromise();this._closeDialog();},afterClose:function(e){e.getSource().destroy();},_createModel:function(){return new J({id:"",title:"",description:"",validation:{id:false}});},_resetModel:function(m){m.setProperty("/id","");m.setProperty("/title","");m.setProperty("/description","");var v=q.extend({},m.getProperty("/validation"),{id:false});m.setProperty("/validation",v);},_createOrResetModel:function(){var f=g();var m=f.getModel();if(!m){f.setModel(this._createModel());return;}this._resetModel(m);},onBeforeOpen:function(){var f=g();sap.ui.getCore().getMessageManager().registerObject(f,true);f.setModel(r.i18nModel,"i18n");f.addEventDelegate({onsapescape:function(){this._rejectSavePagePromise();}.bind(this)});this._createOrResetModel();},onChange:function(e){var f=g();var i=e.getSource();var b=i.getBinding("value");var I=true;var m=f.getModel();var t=b.getType();var s=i.getValue();var v;try{t.validateValue(s);}catch(E){I=false;}v=q.extend({},m.getProperty("/validation"),{id:I});m.setProperty("/validation",v);},validate:function(v){for(var i in v){if(!v[i]){return false;}}return true;}};});
