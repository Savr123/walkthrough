sap.ui.define(["jquery.sap.global","sap/ui/core/format/NumberFormat","sap/ui/core/format/DateFormat","sap/ovp/cards/CommonUtils","sap/ui/model/odata/AnnotationHelper","sap/ui/model/FilterOperator","sap/ui/Device","sap/ui/model/analytics/odata4analytics","sap/ui/generic/app/navigation/service/SelectionVariant","sap/ovp/app/resources"],function(q,N,D,C,O,F,a,o,S,b){"use strict";var f={count:0};var c={};var d={};var e={};var g={StateValues:{None:"None",Negative:"Error",Critical:"Warning",Positive:"Success"},ColorValues:{None:"Neutral",Negative:"Error",Critical:"Critical",Positive:"Good"}};var A={TEXT:"com.sap.vocabularies.Common.v1.Text",TEXT_ARRANGEMENT:"com.sap.vocabularies.UI.v1.TextArrangement"};var T={TEXT_LAST:"com.sap.vocabularies.UI.v1.TextArrangementType/TextLast",TEXT_FIRST:"com.sap.vocabularies.UI.v1.TextArrangementType/TextFirst",TEXT_ONLY:"com.sap.vocabularies.UI.v1.TextArrangementType/TextOnly",TEXT_SEPARATE:"com.sap.vocabularies.UI.v1.TextArrangementType/TextSeparate"};var I={"List_condensed":{phone:5,tablet:5,desktop:5},"List_extended":{phone:3,tablet:3,desktop:3},"List_condensed_bar":{phone:5,tablet:5,desktop:5},"List_extended_bar":{phone:3,tablet:3,desktop:3},"Table":{phone:5,tablet:5,desktop:5},"Stack_simple":{phone:20,tablet:20,desktop:20},"Stack_complex":{phone:5,tablet:5,desktop:5}};function l(i,j){var k=i.getSetting('ovpCardProperties');var $2=k.getProperty('/showLabelText');if($2==="true"){var _2=j.Address[0];if(typeof _2.country!=="undefined"){return"{path:'"+_2.country.Path+"'}";}else if(typeof _2.locality!=="undefined"){return"{path:'"+_2.locality.Path+"'}";}else if(typeof _2.street!=="undefined"){return"{path:'"+_2.street.Path+"'}";}else if(typeof _2.code!=="undefined"){return"{path:'"+_2.code.Path+"'}";}}else{return null;}}l.requiresIContext=true;function h(i,j){if(!j){return"";}if(j.Label){return j.Label.String;}var k=i.getSetting&&i.getSetting('ovpCardProperties');var $2=k&&k.getProperty("/metaModel");var _2=k&&k.getProperty("/entityType");if(!$2||!_2){return"";}var a3;if(j.Value){a3=j.Value.Path;}if(j.Target){var b3=E(_2.$path,j);var c3=b3&&$2.getProperty(b3);a3=c3&&c3.Value.Path;}if(!a3||!a3.length>0||a3===" "){return"";}var d3=$2.getODataProperty(_2,a3);if(!d3){return"";}var e3=d3["sap:label"]||(d3["com.sap.vocabularies.Common.v1.Label"]||"").String||"";return e3;}h.requiresIContext=true;function m(i,k){if(i.getSetting){var j=i.getSetting("_ovpCache");if(j){return j[k];}}return undefined;}function s(i,k,j){if(i.getSetting){var $2=i.getSetting("_ovpCache");if($2){$2[k]=j;}}}function n(i,j){if(!f[j]){f[j]=0;}f[j]++;var k=j+f[j];f[k]=i;return"sap.ovp.cards.AnnotationHelper.formatFunctions."+k;}function p(i,j){var k;if(j){k=j.None;if(i&&i.EnumMember){var $2=i.EnumMember;if(t($2,'Negative')){k=j.Negative;}else if(t($2,'Critical')){k=j.Critical;}else if(t($2,'Positive')){k=j.Positive;}}}return k;}function r(i){if(i=="Error"){i=1;}else if(i=="Warning"){i=2;}else if(i=="Success"){i=3;}else{i=0;}return i;}function t(i,j){return i&&i.indexOf(j,i.length-j.length)!==-1;}function u(i,j,k,$2,_2,a3,b3){var c3={};c3.EnumMember="None";var d3=Number.NEGATIVE_INFINITY;var e3=Number.POSITIVE_INFINITY;if((!_2&&_2!==0)&&(k||k===0)){_2=k;}if((!a3&&a3!==0)&&($2||$2===0)){a3=$2;}if(!k&&k!==0){k=d3;}if(!$2&&$2!==0){$2=e3;}if(i!==undefined){i=Number(i);if(t(j,"Minimize")||t(j,"Minimizing")){if((a3||a3===0)&&($2||$2===0)){if(i<=parseFloat(a3)){c3.EnumMember="Positive";}else if(i>parseFloat($2)){c3.EnumMember="Negative";}else{c3.EnumMember="Critical";}}}else if(t(j,"Maximize")||t(j,"Maximizing")){if((_2||_2===0)&&(k||k===0)){if(i>=parseFloat(_2)){c3.EnumMember="Positive";}else if(i<parseFloat(k)){c3.EnumMember="Negative";}else{c3.EnumMember="Critical";}}}else if(t(j,"Target")){if((a3||a3===0)&&($2||$2===0)&&(_2||_2===0)&&(k||k===0)){if(i>=parseFloat(_2)&&i<=parseFloat(a3)){c3.EnumMember="Positive";}else if(i<parseFloat(k)||i>parseFloat($2)){c3.EnumMember="Negative";}else{c3.EnumMember="Critical";}}}}return p(c3,b3);}function v(i,j,k,$2,_2){if(!i||!j){return;}i=Number(i);if(!$2&&(i-j>=0)){return(_2===false)?"sap-icon://trend-up":"Up";}if(!k&&(i-j<=0)){return(_2===false)?"sap-icon://trend-down":"Down";}if(j&&$2&&(i-j>=$2)){return(_2===false)?"sap-icon://trend-up":"Up";}if(j&&k&&(i-j<=k)){return(_2===false)?"sap-icon://trend-down":"Down";}}function w(i,j){var k=i.getPath(0)+"-DataFields-Sorted";var $2=m(i,k);if(!$2){var _2=x(i,j);var a3=_2.map(function(b3){return b3.Value.Path;});a3=a3.filter(function(b3){return!!b3;});$2=j.filter(function(b3){if(b3.RecordType==="com.sap.vocabularies.UI.v1.DataField"&&a3.indexOf(b3.Value.Path)===-1){return true;}return false;});$2=H($2);s(i,k,$2);}return $2;}w.requiresIContext=true;function x(j,k,$2){var _2=j.getPath(0)+"-DataPoints-Sorted";var a3=m(j,_2);if(!a3){if($2){a3=k.filter(z);}else{a3=k.filter(y);}a3=H(a3);var b3;for(var i=0;i<a3.length;i++){b3=j.getPath(0).substr(0,j.getPath(0).lastIndexOf("/")+1);a3[i]=j.getModel(0).getProperty(E(b3,a3[i]));b3="";}s(j,_2,a3);}return a3;}x.requiresIContext=true;function y(i){if(i.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&i.Target.AnnotationPath.match(/@com.sap.vocabularies.UI.v1.DataPoint.*/)){return true;}return false;}function z(i){if((i.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&i.Target.AnnotationPath.match(/@com.sap.vocabularies.UI.v1.DataPoint.*/))||(i.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&i.Target.AnnotationPath.match(/@com.sap.vocabularies.Communication.v1.Contact.*/))){return true;}return false;}function B(i){if(!i||!i.Criticality||!i.Criticality.Path){return;}return"{path:'"+i.Criticality.Path+"'}";}function E(i,j){if(i&&!t(i,'/')){i+='/';}return i+j.Target.AnnotationPath.slice(1);}function G(i){var j,k;if(i["com.sap.vocabularies.UI.v1.Importance"]){j=i["com.sap.vocabularies.UI.v1.Importance"].EnumMember;switch(j){case"com.sap.vocabularies.UI.v1.ImportanceType/High":k=1;break;case"com.sap.vocabularies.UI.v1.ImportanceType/Medium":k=2;break;case"com.sap.vocabularies.UI.v1.ImportanceType/Low":k=3;break;}}else{k=4;}return k;}function H(i){if(i.length<2){return i;}var j=parseInt(i.length/2,10);var k=i.slice(0,j);var $2=i.slice(j,i.length);return J(H(k),H($2));}function J(i,j){var k=[];while(i.length&&j.length){var $2=G(i[0]),_2=G(j[0]);if($2<=_2){k.push(i.shift());}else{k.push(j.shift());}}while(i.length){k.push(i.shift());}while(j.length){k.push(j.shift());}return k;}function K(i,j,k){var $2=w(i,j)[k];if($2){return V(i,$2);}return"";}function L(i,j,k){var $2=w(i,j)[k];return h(i,$2);}function M(i,j,k){var $2=x(i,j)[k];if($2&&$2.Title){return $2.Title.String;}return"";}function P(i,j,k){var $2=j.filter(y);$2=H($2);if(!$2||!$2.length||!$2.length>0){return"";}return h(i,$2[0]);}function Q(i,j,k,$2){var _2=x(i,j)[k];if(!_2){return"";}var a3=i.getSetting('ovpCardProperties');var b3=a3.getProperty("/entityType");var c3=a3.getProperty("/metaModel");return _(i,_2,b3,c3,$2);}function R(i,j,k){var $2=x(i,j)[k];if($2&&$2.Criticality){return true;}}function U(i,j,k){var $2=x(i,j)[k];var _2=$2.Criticality.Path;return"{path:'"+_2+"'}";}function _(i,j,k,$2,_2){if(!j||!j.Value){return"";}var a3=i.getSetting('ovpCardProperties');var b3=false;if(a3){var c3=a3.getProperty("/ignoreSapText");b3=c3==undefined?b3:c3;}var d3=$2.getODataProperty(k,j.Value.Path);var e3=false;if(b3==true){if(d3&&(d3["com.sap.vocabularies.Analytics.v1.Measure"]||d3["sap:aggregation-role"]=="measure")){e3=true;}}if(!e3&&d3){var f3;if(d3["com.sap.vocabularies.Common.v1.Text"]){f3=d3["com.sap.vocabularies.Common.v1.Text"].String?d3["com.sap.vocabularies.Common.v1.Text"].String:d3["com.sap.vocabularies.Common.v1.Text"].Path;}else if(d3["sap:text"]){f3=d3["sap:text"];}if(f3){d3=$2.getODataProperty(k,f3);j={Value:{Path:d3.name}};}}return V(i,j,_2);}function V(i,j,k,$2){if(j.Value.Apply){return O.format(i,j.Value);}var _2=i.getSetting('ovpCardProperties');var a3=_2.getProperty("/entityType");var b3=_2.getProperty("/metaModel");return X(i,j,a3,b3,k,$2);}V.requiresIContext=true;function W(i,j,k,$2){if((!k)||(typeof $2!=='string')){return $2;}var _2=k[A.TEXT];if(!_2){return $2;}var a3,b3;a3=k[A.TEXT_ARRANGEMENT];b3=a3&&a3.EnumMember;if(!b3){a3=_2&&_2[A.TEXT_ARRANGEMENT];b3=a3&&a3.EnumMember;}if(!b3){a3=j&&j[A.TEXT_ARRANGEMENT];b3=a3&&a3.EnumMember;}if(!b3){return $2;}var c3=O.format(i,_2);if(!c3||c3===" "){return $2;}var d3;switch(b3){case T.TEXT_FIRST:d3=c3+" ("+$2+")";break;case T.TEXT_LAST:d3=$2+" ("+c3+")";break;case T.TEXT_ONLY:d3=c3;break;case T.TEXT_SEPARATE:d3=$2+" ("+c3+")";break;default:d3=$2;break;}return d3;}function X(j,k,$2,_2,a3,b3,c3){if(k.Value.Apply){return O.format(j,k.Value);}var d3=k.Value.Path?k.Value.Path:k.Value.String;var e3=_2.getODataProperty($2,d3),f3="",g3;var h3=j.getSetting("ovpCardProperties");var i3=h3&&h3.getProperty("/contentFragment");if(!b3){if(k.Value.Path&&k.Value.Path.split("/").length>1){e3=d1(_2,$2,k.Value.Path);}if(!e3){return"";}if(e3["type"]==='Edm.DateTime'||e3["type"]==='Edm.DateTimeOffset'){var j3=h3&&h3.getProperty("/showDateInRelativeFormat");g3=a1("dateFormatFunction",j3,e3["type"]==='Edm.DateTime'?true:false);f3=Y([k.Value.Path?k.Value.Path:e3.name],g3);}else if((k.ValueFormat&&k.ValueFormat.NumberOfFractionalDigits)||e3["scale"]){var k3=(k.ValueFormat&&k.ValueFormat.NumberOfFractionalDigits)?k.ValueFormat.NumberOfFractionalDigits.Int:0,l3;var m3=(k.ValueFormat&&k.ValueFormat.ScaleFactor&&k.ValueFormat.ScaleFactor.Decimal);if(e3["Org.OData.Measures.V1.ISOCurrency"]){l3=e3["Org.OData.Measures.V1.ISOCurrency"].Path?e3["Org.OData.Measures.V1.ISOCurrency"].Path:e3["Org.OData.Measures.V1.ISOCurrency"].String;}else if(e3["Org.OData.Measures.V1.Unit"]){l3=e3["Org.OData.Measures.V1.Unit"].Path?e3["Org.OData.Measures.V1.Unit"].Path:e3["Org.OData.Measures.V1.Unit"].String;}else if(e3["sap:unit"]){l3=e3["sap:unit"];}var n3=l3?_2.getODataProperty($2,l3):null,o3=[k.Value.Path?k.Value.Path:e3.name];if(k3>2){k3=2;}if(e3["Org.OData.Measures.V1.ISOCurrency"]){var p3=e3["Org.OData.Measures.V1.ISOCurrency"];if(p3.Path){g3=b1(k3,m3);o3.push(p3.Path);}else if(p3.String){g3=b1(k3,p3.String,m3);}}else if(n3&&(n3["Org.OData.Measures.V1.ISOCurrency"]||n3["sap:semantics"]==="currency-code")){g3=b1(k3,m3);o3.push(l3);}else{g3=Z(k3,m3);}f3=Y(o3,g3);}else{if(c3){f3=O.simplePath(j,k.Value);}else{var q3=O.format(j.getModel()?j:j.getInterface(0),k.Value);var r3=q3.split(",");var s3=[];if(r3.length>1){for(var i=0;i<r3.length;i++){if(r3[i].indexOf("path:")>=0||r3[i].indexOf("type:")>=0){s3.push(r3[i]);}}if(s3.length>0){f3=f3+s3.join(',');if(f3.substring(f3.length-1)!=="}"){f3=f3+"}";}}}else{f3=q3;}}}if(i3){f3=W(j,$2,e3,f3);}if(e3["Org.OData.Measures.V1.Unit"]){var t3=e3["Org.OData.Measures.V1.Unit"];if(t3.Path){f3+=(" "+Y([t3.Path]));}else if(t3.String){if(t3.String!=="%"){f3+=" ";}f3+=t3.String;}}}if(!a3){if(e3["Org.OData.Measures.V1.ISOCurrency"]){var p3=e3["Org.OData.Measures.V1.ISOCurrency"];if(p3.Path){f3+=(" "+Y([p3.Path]));}else if(p3.String){f3+=(" "+p3.String);}}}if(f3[0]===" "){f3=f3.substring(1);}return f3;}function Y(j,k){var $2="",_2=j.length;if(_2>1){$2="{parts:[";for(var i=0;i<_2;i++){$2+=("{path: '"+j[i]+"'}"+((i===_2-1)?"]":", "));}}else{$2="{path: '"+j[0]+"'";}$2+=(k?(", formatter: '"+k+"'"):"")+"}";return $2;}function Z(i,j){var k="formatNumberCalculation"+i;if(!c[k]){c[k]=$(Number(i),j);}return"sap.ovp.cards.AnnotationHelper.NumberFormatFunctions."+k;}function $(i,j){return function(k){var $2=N.getFloatInstance({style:'short',showMeasure:false,shortRefNumber:j,minFractionDigits:i,maxFractionDigits:i});return $2.format(Number(k));};}function a1(i,j,k){var $2={'relative':true,'relativeScale':'auto'};if(j!==undefined&&!j){$2={'style':'medium'};}if(!d[i]){d[i]=function(_2){var a3=D.getInstance($2);if(!_2){_2="";return _2;}return a3.format(new Date(_2),k);};}return"sap.ovp.cards.AnnotationHelper.DateFormatFunctions."+i;}function b1(i,j,k){var $2="formatCurrencyCalculation"+(j?j+i:i);if(!e[$2]){e[$2]=c1(i,j,k);}return"sap.ovp.cards.AnnotationHelper.CurrencyFormatFunctions."+$2;}function c1(i,j,k){return function($2,_2){var a3="";var b3=N.getCurrencyInstance({style:'short',showMeasure:false,shortRefNumber:k,minFractionDigits:i,maxFractionDigits:i});if(_2){a3=b3.format($2,_2);}else{a3=j?b3.format($2,j):b3.format($2);}return a3;};}function d1(j,k,$2){var _2=$2.split("/");if(_2.length>1){for(var i=0;i<(_2.length-1);i++){var a3=j.getODataAssociationEnd(k,_2[i]);if(a3){k=j.getODataEntityType(a3.type);}}return j.getODataProperty(k,_2[_2.length-1]);}}function e1(i,j,k){var $2=x(i,j);var _2=g.StateValues;var a3=$2[k];if(!a3){return _2.None;}if(a3.Criticality){return i1(i,a3,_2);}return k1(i,a3,_2);}function f1(i,j,k){var $2=x(i,j);if($2&&$2.length){var _2=$2[0];if(_2&&(_2.Criticality||_2.CriticalityCalculation)){return true;}}return false;}function g1(i,j,k){if(f1(i,j,k)){return'';}return'#5cbae6';}g1.requiresIContext=true;function h1(i,j,k){var $2=x(i,j),_2=g.ColorValues;var a3=_2.None;if($2.length>k){var b3=$2[k];if(b3&&b3.Criticality){a3=i1(i,b3,_2);}else{a3=k1(i,b3,_2);}}return a3;}function i1(i,j,k){var $2=k.None;var _2;var a3=j.Criticality;if(a3){_2="'{'= ({0} === ''com.sap.vocabularies.UI.v1.CriticalityType/Negative'') || ({0} === ''1'') || ({0} === 1) ? ''"+k.Negative+"'' : "+"({0} === ''com.sap.vocabularies.UI.v1.CriticalityType/Critical'') || ({0} === ''2'') || ({0} === 2) ? ''"+k.Critical+"'' : "+"({0} === ''com.sap.vocabularies.UI.v1.CriticalityType/Positive'') || ({0} === ''3'') || ({0} === 3) ? ''"+k.Positive+"'' : "+"''"+k.None+"'' '}'";if(a3.Path){var b3='$'+O.simplePath(i,a3);$2=q.sap.formatMessage(_2,b3);}else if(a3.EnumMember){var c3="'"+a3.EnumMember+"'";$2=q.sap.formatMessage(_2,c3);}else{q.sap.log.warning("Case not supported, returning the default Neutral state");}}else{q.sap.log.warning("Case not supported, returning the default Neutral state");}return $2;}function j1(i,j,k){var $2=x(i,j);var _2="None";if($2.length>k){var a3=$2[k];if(a3&&a3.Criticality&&a3.Criticality.Path){_2=U(i,j,k);}else{_2=k1(i,a3,g.StateValues);_2=r(_2);}}return _2;}function k1(i,j,k){var $2=k.None;if(j.Criticality){$2=p(j.Criticality,k);}else if(j.CriticalityCalculation&&j.Value&&j.Value&&j.Value.Path){$2=l1(i,j,k);}return $2;}function l1(i,j,k){var $2=C1(j.Value);var _2=j.CriticalityCalculation.ImprovementDirection.EnumMember;var a3=C1(j.CriticalityCalculation.DeviationRangeLowValue);var b3=C1(j.CriticalityCalculation.DeviationRangeHighValue);var c3=C1(j.CriticalityCalculation.ToleranceRangeLowValue);var d3=C1(j.CriticalityCalculation.ToleranceRangeHighValue);var e3=m1(a3);var f3=m1(b3);var g3=m1(c3);var h3=m1(d3);var i3="parts: ["+$2;i3+=e3?","+a3:"";i3+=f3?","+b3:"";i3+=g3?","+c3:"";i3+=h3?","+d3:"";i3+="]";var j3=function(){var l3=1;return u(arguments[0],_2,e3?arguments[l3++]:a3,f3?arguments[l3++]:b3,g3?arguments[l3++]:c3,h3?arguments[l3++]:d3,k);};var k3=n(j3,"formatCriticalityCalculation");return"{"+i3+", formatter: '"+k3+"'}";}function m1(i){return(typeof i==="string")&&i.charAt(0)==="{";}function n1(j,k,$2){var _2="";var a3=$2.split("/");if(a3.length>1){for(var i=0;i<(a3.length-1);i++){var b3=j.getODataAssociationEnd(k,a3[i]);if(b3){k=j.getODataEntityType(b3.type);if(_2){_2=_2+"/";}_2=_2+a3[i];}else{return _2;}}}return _2;}function o1(i){var j;if(i&&typeof i.getData==='function'){var k=i.getData();if(k.tabs){var $2=0;var _2=k.selectedKey;if(_2&&k.tabs.length>=_2){$2=_2-1;}j=k.tabs[$2].mFilterPreference;}else{j=k.mFilterPreference;}}return!!j;}function p1(j,k){var $2=j.getSetting('ovpCardProperties');var _2=$2.getProperty("/addODataSelect");var a3=$2.getProperty("/metaModel");var b3=a3.getODataEntityType(k.entityType);var c3=b3[$2.getProperty('/selectionAnnotationPath')];var d3=b3[$2.getProperty('/presentationAnnotationPath')];var e3="/"+k.name;var f3=Array.prototype.slice.call(arguments,2);var g3=j.getSetting('ovpCardProperties'),h3=g3.getProperty('/parameters');if(c3||!!h3){if((c3&&c3.Parameters&&c3.Parameters.length>0)||!!h3){e3=w2(j.getSetting('dataModel'),k,c3,h3);}}if($2.getProperty("/cardLayout")&&$2.getProperty("/cardLayout/noOfItems")){var i3="{path: '"+e3+"', length: "+ +($2.getProperty("/cardLayout/noOfItems"));}else{var i3="{path: '"+e3+"', length: "+D1($2);}var j3=[];if(_2){j3=r1(j,a3,b3,f3);var k3=$2.getProperty("/template");if(k3!="sap.ovp.cards.charts.analytical"&&k3!="sap.ovp.cards.charts.smart.chart"){var l3=u1(d3);for(var i=0;i<l3.length;i++){if(!j3.includes(l3[i])){j3.push(l3[i]);}}}}var m3=q1(a3,b3,f3);var n3=o1($2);if(n3||j3.length>0||m3.length>0){i3=i3+", parameters: {";}if(j3.length>0||m3.length>0){if(j3.length>0){i3=i3+"select: '"+j3.join(',')+"'";}if(m3.length>0){if(j3.length>0){i3=i3+", ";}i3=i3+"expand: '"+m3.join(',')+"'";}if(n3){i3=i3+", ";}}if(n3){i3=i3+"custom: {cardId: '"+$2.getProperty("/cardId")+"'}";}if(n3||j3.length>0||m3.length>0){i3=i3+"}";}var o3=t1($2,d3);if(o3.length>0){i3=i3+", sorter:"+JSON.stringify(o3);}var p3=y1($2,c3);if(p3.length>0){i3=i3+", filters:"+JSON.stringify(p3);}i3=i3+"}";return i3;}p1.requiresIContext=true;function q1(k,$2,_2){var a3=[];var b3,c3,d3,e3;for(var i=0;i<_2.length;i++){if(!_2[i]){continue;}b3=$2.$path+"/"+_2[i];c3=k.createBindingContext(b3);d3=c3.getObject();d3=d3?d3:[];for(var j=0;j<d3.length;j++){if(d3[j].Value&&d3[j].Value.Path){e3=n1(k,$2,d3[j].Value.Path);if(e3&&a3.indexOf(e3)===-1){a3.push(e3);}}}}return a3;}function r1($2,_2,a3,b3){var c3=[];var d3,e3,f3;for(var i=0;i<b3.length;i++){if(!b3[i]){continue;}d3=a3.$path+"/"+b3[i];e3=_2.createBindingContext(d3);var g3={};if($2&&$2.bDummyContext){q.extend(g3,$2,e3,true);}else{g3=$2;}f3=e3.getObject();if(!f3){f3=[];}else if(q.isPlainObject(f3)){if(f3.Data){f3=f3.Data;}else{f3=[];}}var h3;var i3;var j3;var k3;for(var j=0;j<f3.length;j++){i3=[];h3=f3[j];j3="";k3=h3.RecordType;if(k3==="com.sap.vocabularies.UI.v1.DataField"){j3=X(g3,h3,a3,_2,undefined,undefined,true);}else if(k3==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"){var l3=E(a3.$path,h3);j3=_(g3,_2.getProperty(l3),a3,_2);var m3=B(_2.getProperty(l3));if(m3&&m3.length>0){j3+=m3;}}else if(k3==="com.sap.vocabularies.UI.v1.DataFieldWithUrl"&&h3.Url){var n3;if(!h3.Url.UrlRef){n3=O.format(g3,h3.Url);}if(n3&&n3.substring(0,2)==="{="){j3=n3;}}if(j3){var o3=O.simplePath(g3,h3.Value);if(j3.indexOf("(")<0&&j3!==o3){j3=[].concat(o3,j3).join(" ");}i3=s1(j3);}if(i3&&i3.length>0){var p3;for(var k=0;k<i3.length;k++){p3=i3[k];if(!c3[p3]){c3[p3]=true;var q3=C.getUnitColumn(p3,a3);if(q3&&q3!==p3){c3[q3]=true;}var r3=X2(_2,a3,p3);if(r3&&r3!==p3){c3[r3]=true;}}}}}}return Object.keys(c3);}function s1(j){var i,k=0,$2=j.length,_2="",a3;for(i=0;i<$2;i++){a3=j.charAt(i);if(!a3){return;}switch(a3){case"{":k++;break;case"}":k--;break;default:if(k<=0){continue;}break;}_2+=a3;}j=_2;var b3=/\${([a-zA-Z0-9\_|\/]*)/g;var c3=/[^[{]*[a-zA-Z0-9\_]/g;var d3=/path *\: *\'([a-zA-Z0-9\_]+)*\'/g;var e3,f3,g3=[];if(j.indexOf("{parts:[")!==-1){j=j.replace("{parts:[","");}if(j.substring(0,2)==="{="){e3=b3;f3=1;}else if(j.indexOf("path")!==-1){var h3=c3.exec(j);while(h3){if(h3[0].indexOf("path")===-1&&h3[0].indexOf("@i18n")!==0){g3.push(h3[0]);}h3=c3.exec(j);}e3=d3;f3=1;}else{e3=c3;f3=0;}var i3=e3.exec(j);while(i3){if(i3[f3]&&i3[f3].indexOf("@i18n")!==0){g3.push(i3[f3]);}i3=e3.exec(j);}return g3;}function t1(j,k){var $2=[];var _2,a3;var b3=j.getProperty("/sortBy");if(b3){var c3=j.getProperty('/sortOrder');if(c3&&c3.toLowerCase()!=='descending'){a3=false;}else{a3=true;}_2={path:b3,descending:a3};$2.push(_2);}var d3=k&&k.SortOrder||undefined;var e3,b3;if(d3){for(var i=0;i<d3.length;i++){e3=d3[i];b3=e3.Property.PropertyPath;a3=z1(e3.Descending,true);_2={path:b3,descending:a3};$2.push(_2);}}return $2;}function u1(j){var k=[];var $2=j&&j.RequestAtLeast||undefined;if($2){for(var i=0;i<$2.length;i++){if($2[i].PropertyPath){k.push($2[i].PropertyPath);}}}return k;}function v1(i){var j=i.getProperty('/entityType');var k=j[i.getProperty('/selectionAnnotationPath')];return{filters:y1(i,k),parameters:x1(k)};}function w1(j){if(!j){return;}var k=j.getProperty('/entityType');var $2=k[j.getProperty('/presentationAnnotationPath')];var _2=t1(j,$2);var a3=[];var i,b3=_2.length;for(i=0;i<b3;i++){if(!_2[i].path){continue;}a3.push({Property:_2[i].path,Descending:_2[i].descending});}if(a3.length>0){return{SortOrder:a3};}}function x1(j){var k,$2=[];if(!j||!j.Parameters){return $2;}var _2=j.Parameters.length;for(var i=0;i<_2;i++){k=j.Parameters[i];if(!k.PropertyName||!k.PropertyName.PropertyPath){continue;}if(!k.PropertyValue){q.sap.log.error("Missing value for parameter "+k.PropertyName.PropertyPath);continue;}$2[$2.length]={path:k.PropertyName.PropertyPath,value:B1(k.PropertyValue)};}return $2;}function y1(k,$2){var _2=[];var a3;var b3=k.getProperty("/filters");if(b3){_2=_2.concat(b3);}if($2&&$2.SelectOptions){a3=$2.SelectOptions;}else{a3=$2;}var c3,d3,e3;if(a3){for(var i=0;i<a3.length;i++){c3=a3[i];d3=c3.PropertyName.PropertyPath;for(var j=0;j<c3.Ranges.length;j++){e3=c3.Ranges[j];if(e3.Sign.EnumMember){var f3={path:d3,operator:e3.Option.EnumMember.split("/")[1],value1:B1(e3.Low),value2:B1(e3.High),sign:e3.Sign.EnumMember==="com.sap.vocabularies.UI.v1.SelectionRangeSignType/I"?"I":"E"};if(f3.sign==="E"&&f3.operator!==F.EQ){q.sap.log.error("Exclude sign is supported only with EQ operator");continue;}if(f3.sign==="E"&&f3.operator===F.EQ){f3.operator=F.NE;f3.sign="I";}if(f3.operator==="CP"&&f3.sign==="I"){var g3=F.Contains;var h3=f3.value1;if(h3){var i3=h3.indexOf('*');var j3=h3.lastIndexOf('*');if(i3>-1){if((i3===0)&&(j3!==(h3.length-1))){g3=F.EndsWith;h3=h3.substring(1,h3.length);}else if((i3!==0)&&(j3===(h3.length-1))){g3=F.StartsWith;h3=h3.substring(0,h3.length-1);}else{h3=h3.substring(1,h3.length-1);}}}f3.operator=g3;f3.value1=h3;}_2.push(f3);}}}}return _2;}function z1(i,j){if(i&&i.Boolean){if(i.Boolean.toLowerCase()==="true"){return true;}else if(i.Boolean.toLowerCase()==="false"){return false;}}else if(i&&i.Bool){if(i.Bool.toLowerCase()==="true"){return true;}else if(i.Bool.toLowerCase()==="false"){return false;}}return j;}function A1(i){var j;if(i){if(i.String){j=Number(i.String);}else if(i.Int){j=Number(i.Int);}else if(i.Decimal){j=Number(i.Decimal);}else if(i.Double){j=Number(i.Double);}else if(i.Single){j=Number(i.Single);}}return j;}function B1(i){var j;if(i){if(i.String||i.String===""){j=i.String;}else if(i.Boolean||i.Bool){j=z1(i);}else if(i.DateTime){j=i.DateTime;}else if(i.DateTimeOffset){j=i.DateTimeOffset;}else{j=A1(i);}}return j;}function C1(i){if(i){if(i.Path){return"{path:'"+i.Path+"'}";}else{return B1(i);}}else{return"";}}function D1(i){var j=i.getProperty('/contentFragment');var k=i.getProperty('/listType');var $2=i.getProperty('/listFlavor');var _2;var a3="desktop";if(a.system.phone){a3="phone";}else if(a.system.tablet){a3="tablet";}if(j=="sap.ovp.cards.list.List"){if(k=="extended"){if($2=="bar"){_2=I["List_extended_bar"];}else{_2=I["List_extended"];}}else if($2=="bar"){_2=I["List_condensed_bar"];}else{_2=I["List_condensed"];}}else if(j=="sap.ovp.cards.table.Table"){_2=I["Table"];}else if(j=="sap.ovp.cards.stack.Stack"){if(i.getProperty('/objectStreamCardsNavigationProperty')){_2=I["Stack_complex"];}else{_2=I["Stack_simple"];}}if(_2){return _2[a3];}return 5;}function E1(i){var j=i.getObject();var k=x(i,j,true);var $2=k.map(function(_2){if(_2&&_2.Value&&_2.Value.Path){return _2.Value.Path;}else if(_2&&_2.fn&&_2.fn.Path){return _2.fn.Path;}});j.filter(function(_2,a3){if(_2.RecordType==="com.sap.vocabularies.UI.v1.DataField"&&$2.indexOf(_2.Value.Path)>-1){j.splice(a3,1);}});}E1.requiresIContext=true;function F1(i,j){if(j.charAt(0)==='/'||j.indexOf("http")===0){return j;}var k=i.getModel(0).getProperty("/baseUrl");if(k){return k+"/"+j;}return j;}F1.requiresIContext=true;function G1(i,j){var k=x(i,j);return k.length;}G1.requiresIContext=true;function H1(i,j){return J1(i,j,0);}H1.requiresIContext=true;function I1(i,j){return J1(i,j,1);}I1.requiresIContext=true;function J1(i,j,k){var $2=x(i,j),_2=$2[k];if(_2&&_2.Value&&_2.Value.Path){return _2.Value.Path;}return"";}function K1(i,j){return L(i,j,0);}K1.requiresIContext=true;function L1(i,j){return L(i,j,1);}L1.requiresIContext=true;function M1(i,j){return L(i,j,2);}M1.requiresIContext=true;function N1(i,j){return L(i,j,3);}N1.requiresIContext=true;function O1(i,j){return L(i,j,4);}O1.requiresIContext=true;function P1(i,j,k){return K(i,j,k);}P1.requiresIContext=true;function Q1(i,j,k){return Q(i,j,k);}Q1.requiresIContext=true;function R1(i,j,k,$2){var _2=G1(i,j);if(_2>0){return Q1(i,j,k);}else{return P1(i,j,$2);}}R1.requiresIContext=true;function S1(i,j,k){return l2(i,j,k);}S1.requiresIContext=true;function T1(i,j){return M(i,j,0);}T1.requiresIContext=true;function U1(i,j){return M(i,j,1);}U1.requiresIContext=true;function V1(i,j){return M(i,j,2);}V1.requiresIContext=true;function W1(i,j){return P(i,j,0);}W1.requiresIContext=true;function X1(j,k){for(var i=0;i<k.length;i++){var $2=k[i];if($2.RecordType==="com.sap.vocabularies.UI.v1.DataField"){if($2.IconUrl&&$2.IconUrl.String){return $2.IconUrl.String;}if($2.IconUrl&&$2.IconUrl.Path){return O.simplePath(j,$2.IconUrl);}}}}X1.requiresIContext=true;function Y1(i,j,k){var $2="";var _2;if(q.isArray(j)){_2=x(i,j)[k];}else{var a3=q.extend({},j);var b3=q.extend({},i);_2=j2(b3,a3);}if(!_2||!_2.Value){return $2;}var c3=i.getSetting('ovpCardProperties');var d3=c3&&c3.getProperty("/entityType");var e3=c3&&c3.getProperty("/metaModel");var f3=e3&&e3.getODataProperty(d3,_2.Value.Path);var g3=f3&&f3["Org.OData.Measures.V1.ISOCurrency"];if(g3&&g3.Path){$2+=(" "+Y([g3.Path]));}else if(g3&&g3.String){$2+=(" "+g3.String);}return $2;}Y1.requiresIContext=true;function Z1(i,j,k,$2){return Q(i,j,k,$2);}Z1.requiresIContext=true;function $1(i,j){return e1(i,j,0);}$1.requiresIContext=true;function _1(i,j){return h1(i,j,0);}_1.requiresIContext=true;function a2(i,j){return e1(i,j,1);}a2.requiresIContext=true;function b2(i,j){return e1(i,j,2);}b2.requiresIContext=true;function c2(i,j){return j1(i,j,0);}c2.requiresIContext=true;function d2(i){var j={};j.EnumMember="None";if(Number(i)===1){j.EnumMember="Negative";}else if(Number(i)===2){j.EnumMember="Critical";}else if(Number(i)===3){j.EnumMember="Positive";}return p(j,g.ColorValues);}function e2(i,j){if(j&&j.Criticality&&j.Criticality.Path){return"{parts: [{path:'"+j.Criticality.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.kpiValueCriticality'}";}else{return k1(i,j,g.ColorValues);}}e2.requiresIContext=true;function f2(i,j){return R(i,j,0);}f2.requiresIContext=true;function g2(i,j){var k=x(i,j)[0];if(k&&(k.Criticality||k.CriticalityCalculation)){return true;}return false;}g2.requiresIContext=true;function h2(i,j){return R(i,j,1);}h2.requiresIContext=true;function i2(i,j){return R(i,j,2);}i2.requiresIContext=true;function j2(i,j){var k=i.getPath(0);var $2=k.slice(0,k.lastIndexOf("/"));$2=$2.slice(0,$2.lastIndexOf("/"));var _2=E($2,j);j=i.getModel(0).getProperty(_2);return j;}function k2(i,j){if(!j){return"";}return V(i,j);}k2.requiresIContext=true;function l2(j,k,$2,_2){var a3;var b3=_2==undefined?$2:w(j,$2)[_2];var c3=j.getSetting('ovpCardProperties');var d3=c3.getProperty("/metaModel");var e3=d3.getODataEntityType(k.entityType);var f3=e3.property;if(f3){for(var i=0;i<f3.length;i++){if(b3.Value.Path===f3[i].name){a3=f3[i]["com.sap.vocabularies.Common.v1.SemanticObject"];if(a3){return O.format(j,a3);}else{return"";}}}}}function m2(i,j,k){var $2=k===undefined?j.Value.Path:j[k].Value.Path;var _2=($2.indexOf("/")!=-1)?$2.split('/')[0]:"";return _2;}m2.requiresIContext=true;function n2(i,j){var k=i.getSetting('ovpCardProperties');var $2=k.getProperty("/metaModel");var _2=$2.getODataEntityType(j.entityType);if(_2["com.sap.vocabularies.Communication.v1.Contact"]){return true;}return false;}n2.requiresIContext=true;function o2(i,j,k){if(!j){return"";}var $2=i.getSetting('ovpCardProperties');var _2=$2.getProperty("/entityType");var a3=$2.getProperty("/metaModel");var b3=q.extend({},j);var c3=q.extend({},i);j=j2(c3,b3);return _(i,j,_2,a3,k);}o2.requiresIContext=true;function p2(i,j){var k=q.extend({},j);var $2=q.extend({},i);var _2="None",a3=g.StateValues;j=j2($2,k);if(j&&j.Criticality){_2=i1(i,j,a3);}else{_2=k1(i,j,a3);}return _2;}p2.requiresIContext=true;function q2(i,j){var k=q.extend({},j);var $2=q.extend({},i);j=j2($2,k);if(j&&j.Criticality){return true;}}q2.requiresIContext=true;function r2(i,j){var k=q.extend({},j);var $2=q.extend({},i);var _2=i.getSetting('ovpCardProperties');var a3=_2.getProperty("/entityType");var b3=_2.getProperty("/metaModel");j=j2($2,k);if(!j){return;}var c3=b3.getODataProperty(a3,j.Value.Path);if(j&&c3&&c3.type=="Edm.String"&&(j.Criticality||j.CriticalityCalculation)){return true;}}r2.requiresIContext=true;function s2(i,j){var k=q.extend({},j);var $2=q.extend({},i);j=j2($2,k);var _2="None";if(j&&j.Criticality&&j.Criticality.Path){_2="{path:'"+j.Criticality.Path+"'}";}else{_2=k1(i,j,g.StateValues);_2=r(_2);}return _2;}s2.requiresIContext=true;function t2(j,k){var $2;for(var i=0;i<k.length;i++){$2=k[i];if($2.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"||$2.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAction"||$2.RecordType==="com.sap.vocabularies.UI.v1.DataFieldWithUrl"){return 1;}}return 0;}t2.requiresIContext=true;function u2(i,j){var k=x(i,j)[0];if(k&&k.Value&&k.Value.Path){var $2=i.getPath(0).substr(0,i.getPath(0).lastIndexOf("/")+1);var _2=i.getModel(0);var a3=_2.getProperty($2);var b3=_2.getODataProperty(a3,k.Value.Path);if(b3&&b3["Org.OData.Measures.V1.Unit"]){return b3["Org.OData.Measures.V1.Unit"].String==="%";}}return false;}u2.requiresIContext=true;function v2(i){var j=i.getObject();var k=i.getModel();var $2=k.getProperty("/metaModel");var _2=$2.getODataEntitySet(k.getProperty("/entitySet"));var a3=$2.getODataEntityType(_2.entityType);j=a3.$path+"/"+j;return $2.createBindingContext(j);}function w2(j,k,$2,_2,a3){var b3="";var c3=new o.Model(o.Model.ReferenceByModel(j));var d3=c3.findQueryResultByName(k.name);if(!d3){b3="/"+k.name;return b3;}var e3=new o.QueryResultRequest(d3);var f3=d3.getParameterization();if(!f3){b3="/"+k.name;return b3;}if(a3){var g3=a3.getAnalyticalParameters();}if(f3){var h3;e3.setParameterizationRequest(new o.ParameterizationRequest(f3));if($2&&$2.Parameters){q.each($2.Parameters,function(){if(this.RecordType==="com.sap.vocabularies.UI.v1.IntervalParameter"){h3=this.PropertyNameFrom.PropertyPath.split("/");e3.getParameterizationRequest().setParameterValue(h3[h3.length-1],this.PropertyValueFrom.String,this.PropertyValueTo.String);}else{h3=this.PropertyName.PropertyPath.split("/");e3.getParameterizationRequest().setParameterValue(h3[h3.length-1],this.PropertyValue.String);}});}else if(_2){q.each(_2,function(){e3.getParameterizationRequest().setParameterValue(this.path,this.value);});}else if(g3&&g3.length>0){var i3=a3&&a3.getUiState({allFilters:false});var j3=i3?JSON.stringify(i3.getSelectionVariant()):"{}";var $2=new S(j3);for(var k3 in f3.getAllParameters()){for(var i=0;i<g3.length;i++){if(g3[i]&&(g3[i].name==k3)){var l3=g3[i].name;var m3=$2.getParameter(l3);if(!m3){var n3=$2.getSelectOption(l3);m3=n3&&n3[0]&&n3[0].Low;}e3.getParameterizationRequest().setParameterValue(k3,m3);}}}}else{b3="/"+k.name;q.sap.log.error("SelectionParameters","There are no parameters to resolve");return b3;}}try{b3=e3.getURIToQueryResultEntitySet();}catch(o3){d3=e3.getQueryResult();b3="/"+d3.getEntitySet().getQName();q.sap.log.error("getEntitySetPathWithParameters","binding path with parameters failed - "+o3||o3.message);}return b3;}function x2(j,k,ns){var $2=j.getServiceMetadata().dataServices.schema[0].association;for(var i=0;i<$2.length;i++){if(ns+"."+$2[i].name===k){return $2[i];}}}function y2(i,j){var k=i.filter(function(_2){if(_2.RecordType==="com.sap.vocabularies.UI.v1.DataField"){return true;}return false;});var $2=H(k);if($2){return $2[j];}return;}function z2(i,j,k){if(!k||!k.length||k.length===0){return false;}k=y2(k,0);return l2(i,j,k);}z2.requiresIContext=true;function A2(i,j,k){if(!k||!k.length||k.length===0){return false;}k=y2(k,1);return l2(i,j,k);}A2.requiresIContext=true;function B2(i,j){var k=i.filter(function(_2){if(_2.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&_2.Target.AnnotationPath.indexOf("@com.sap.vocabularies.Communication.v1.Contact")!==-1){return true;}return false;});var $2=H(k);if($2){return $2[j];}return;}function C2(i){if(!i||!i.length||i.length===0){return false;}var j=B2(i,0);if(j){return true;}return false;}function D2(i,j,k,$2){var _2,a3,b3;if(k&&k.Value&&k.Value.Path){_2=k.Value.Path;}else if(k&&k.Description&&k.Description.Value&&k.Description.Value.Path){_2=k.Description.Value.Path;}if(k&&k.Description&&k.Description.Path){a3=k.Description.Path;}else if(k&&k.Title&&k.Title.Path){b3=k.Title.Path;}var c3="";var d3=$2&&$2.Parameters;var e3="";var f3=i.getSetting('ovpCardProperties'),g3=f3.getProperty('/parameters');d3=d3||!!g3;if(d3){var h3=i.getSetting("dataModel");var i3=w2(h3,j,$2,g3);c3+="{path: '"+i3+"'";}else{c3+="{path: '/"+j.name+"'";}c3+=", length: 1";var j3=i.getSetting('ovpCardProperties');var k3=j3.getProperty("/entityType");var l3=C.getUnitColumn(_2,k3);var m3=y1(j3,$2);if(m3.length>0){e3+=", filters: "+JSON.stringify(m3);}var n3=[];n3.push(_2);if(a3){n3.push(a3);}else if(b3){n3.push(b3);}if(k&&k.Criticality&&k.Criticality.Path){n3.push(k.Criticality.Path);}if(k&&k.CriticalityCalculation&&k.CriticalityCalculation.DeviationRangeLowValue&&k.CriticalityCalculation.DeviationRangeLowValue.Path){n3.push(k.CriticalityCalculation.DeviationRangeLowValue.Path);}if(k&&k.CriticalityCalculation&&k.CriticalityCalculation.ToleranceRangeLowValue&&k.CriticalityCalculation.ToleranceRangeLowValue.Path){n3.push(k.CriticalityCalculation.ToleranceRangeLowValue.Path);}if(k&&k.CriticalityCalculation&&k.CriticalityCalculation.DeviationRangeHighValue&&k.CriticalityCalculation.DeviationRangeHighValue.Path){n3.push(k.CriticalityCalculation.DeviationRangeHighValue.Path);}if(k&&k.CriticalityCalculation&&k.CriticalityCalculation.ToleranceRangeHighValue&&k.CriticalityCalculation.ToleranceRangeHighValue.Path){n3.push(k.CriticalityCalculation.ToleranceRangeHighValue.Path);}if(l3){n3.push(l3);}if(k&&k.TrendCalculation&&k.TrendCalculation.ReferenceValue&&k.TrendCalculation.ReferenceValue.Path){n3.push(k.TrendCalculation.ReferenceValue.Path);}var o3=o1(f3);var p3=o3?", custom: {cardId: '"+f3.getProperty("/cardId")+"'}":"";return c3+", parameters:{select:'"+n3.join(",")+"'"+p3+"}"+e3+"}";}D2.requiresIContext=true;function E2(k){if(isNaN(k)){return k;}var i,j,$2=false;if(this.oPropagatedProperties.oModels.ovpCardProperties.oData.NumberOfFractionalDigits){i=Number(this.oPropagatedProperties.oModels.ovpCardProperties.oData.NumberOfFractionalDigits);}if(this.oPropagatedProperties.oModels.ovpCardProperties.oData.percentageAvailable){$2=true;}if(!i||i<0){i=0;}else if(i>2){i=2;}j=k;if(k){var _2=N.getFloatInstance({minFractionDigits:i,maxFractionDigits:i,style:"short",showScale:true,shortRefNumber:j});if($2){return _2.format(Number(k))+" %";}else{return _2.format(Number(k));}}}function F2(i){if(!i||!i.Value||!i.Value.Path){return"";}if(i&&i.ValueFormat&&i.ValueFormat.NumberOfFractionalDigits&&i.ValueFormat.NumberOfFractionalDigits.Int){this.getModel("ovpCardProperties").oData.NumberOfFractionalDigits=i.ValueFormat.NumberOfFractionalDigits.Int;}var j=this.getModel('ovpCardProperties');var k=j.getProperty("/entityType");var $2=j.getProperty("/metaModel");var _2=$2.getODataProperty(k,i.Value.Path);if(_2["Org.OData.Measures.V1.Unit"]){var a3=_2["Org.OData.Measures.V1.Unit"];if(a3.String=="%"){this.getModel("ovpCardProperties").oData.percentageAvailable=true;}}return"{parts: [{path:'"+i.Value.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.KpiValueFormatter'}";}function G2(i,j,k){if(!j||!j.Value||!j.Value.Path||!j.TrendCalculation){return"";}var $2=C1(j.Value);var _2=C1(j.TrendCalculation.ReferenceValue);var a3=C1(j.TrendCalculation.DownDifference);var b3=C1(j.TrendCalculation.UpDifference);var c3=m1(_2);var d3=m1(a3);var e3=m1(b3);var f3="parts: ["+$2;f3+=c3?","+_2:"";f3+=d3?","+a3:"";f3+=e3?","+b3:"";f3+="]";var g3=function(){var i3=1;return v(arguments[0],c3?arguments[i3++]:_2,d3?arguments[i3++]:a3,e3?arguments[i3++]:b3,k);};var h3=n(g3,"formatTrendDirection");return"{"+f3+", formatter: '"+h3+"'}";}G2.requiresIContext=true;function H2(i){if(!i||!i.TrendCalculation||!i.TrendCalculation.ReferenceValue){return"";}if(i&&i.ValueFormat&&i.ValueFormat.NumberOfFractionalDigits&&i.ValueFormat.NumberOfFractionalDigits.Int){this.getModel("ovpCardProperties").oData.NumberOfFractionalDigits=i.ValueFormat.NumberOfFractionalDigits.Int;}if(i.TrendCalculation.ReferenceValue.Path){return"{parts: [{path:'"+i.Value.Path+"'}, {path:'"+i.TrendCalculation.ReferenceValue.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.returnPercentageChange'}";}else{return"{parts: [{path:'"+i.Value.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.returnPercentageChange'}";}}function I2(k,i){var j,$2,_2,a3,b3=false;if(isNaN(+k)){return"";}if(k==0){a3=i;}else{a3=k;}$2=this.getModel('ovpCardProperties');if($2.getProperty("/iNumberOfFractionalDigits")){_2=+($2.getProperty("/iNumberOfFractionalDigits"));}if($2.getProperty("/bPercentageAvailableForTarget")){b3=true;}if(i){j=i;}else{if($2.getProperty("/sManifestTargetValue")){j=$2.getProperty("/sManifestTargetValue");}}if(!_2||_2<0){_2=0;}else if(_2>2){_2=2;}if(j){var c3=N.getFloatInstance({minFractionDigits:_2,maxFractionDigits:_2,style:"short",showScale:true,shortRefNumber:a3});if(b3){return c3.format(+(j))+" %";}else{return c3.format(+(j));}}}function J2(i){if(!i||!i.TrendCalculation||!i.TrendCalculation.ReferenceValue){return"";}if(!i||!i.Value||!i.Value.Path){return"";}var j=this.getModel('ovpCardProperties');var k=j.getProperty("/entityType");var $2=j.getProperty("/metaModel");if(i&&i.ValueFormat&&i.ValueFormat.NumberOfFractionalDigits&&i.ValueFormat.NumberOfFractionalDigits.Int){j.setProperty("/iNumberOfFractionalDigits",i.ValueFormat.NumberOfFractionalDigits.Int);}if(i.TrendCalculation.ReferenceValue){if(i.TrendCalculation.ReferenceValue.String){j.setProperty("/sManifestTargetValue",i.TrendCalculation.ReferenceValue.String);return"{parts: [{path:'"+i.Value.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.TargetValueFormatter'}";}if(i.TrendCalculation.ReferenceValue.Path){var _2=$2.getODataProperty(k,i.TrendCalculation.ReferenceValue.Path);if(_2["Org.OData.Measures.V1.Unit"]){var a3=_2["Org.OData.Measures.V1.Unit"];if(a3.String=="%"){j.setProperty("/bPercentageAvailableForTarget",true);}}return"{parts: [{path:'"+i.Value.Path+"'},{path:'"+i.TrendCalculation.ReferenceValue.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.TargetValueFormatter'}";}}}function K2(k,i){var j,$2,_2;if(isNaN(+k)){return"";}k=+(k);_2=this.getModel('ovpCardProperties');if(_2.getProperty("/iNumberOfFractionalDigits")){j=+(_2.getProperty("/iNumberOfFractionalDigits"));}if(i){$2=+(i);}else{if(_2.getProperty("/sManifestTargetValue")){$2=+(_2.getProperty("/sManifestTargetValue"));}}if(!j||j<0){j=0;}else if(j>2){j=2;}if($2){var a3=((k-$2)/$2);var b3=N.getPercentInstance({style:'short',minFractionDigits:j,maxFractionDigits:j,showScale:true});return b3.format(a3);}}function L2(i){if(i&&i.GroupBy&&!(q.isEmptyObject(i.GroupBy))&&i.GroupBy[0].hasOwnProperty('PropertyPath')){return true;}else{return false;}}function M2(j,k){var $2;for(var i=0;j&&i<j.length;i++){if(j[i].value==k){$2=j[i];break;}}return $2?$2.name:null;}function N2(i,k){return M2(i,k);}function O2(i,k){var j=M2(i,k);return j?j:b.getText("OVP_KEYUSER_LABEL_NO_NAVIGATION");}function P2(i){var j="";var k=i&&i.GroupBy;if(!k){return j;}var $2=this.getModel('ovpCardProperties').getProperty("/metaModel");var _2=this.getModel('ovpCardProperties').getProperty("/entityType");var a3;if(i.GroupBy.constructor===Array){a3=i.GroupBy;}else if(!i.GroupBy.Collection){return j;}else{a3=i.GroupBy.Collection;}var b3;q.each(a3,function(){b3=W2($2,_2,this.PropertyPath);if(!b3){return;}j+=b3;j+=", ";});if(j[j.length-1]===" "&&j[j.length-2]===","){j=j.substring(0,j.length-2);}return j==""?"":b.getText("By",[j]);}function Q2(i,j,k){var $2=true;var _2=k["SelectOptions"].length-1;if(j.PropertyName.PropertyPath===k["SelectOptions"][_2].PropertyName.PropertyPath){$2=false;}j=[j];var a3=i.getSetting('ovpCardProperties');var b3=a3.getProperty("/entityType");var c3=a3.getProperty("/metaModel");var d3=y1(a3,j);if(d3.length==0){return"";}var e3;var f3;e3=d3[0].path;f3=X2(c3,b3,e3);if(f3!==e3){return"";}var g3=c3.getODataProperty(b3,j[0].PropertyName.PropertyPath)["type"];var h3=U2(d3,g3);if($2===true){return h3+", ";}return h3;}Q2.requiresIContext=true;function R2(i,j,k){var $2=!(j.index===(k.length-1));var _2=i.getSetting('ovpCardProperties');var a3=_2.getProperty("/metaModel");var b3=_2.getProperty("/entityType");var c3=a3.getODataProperty(b3,k[j.index].path)["type"];var d3=U2([k[j.index]],c3);if($2===true){return d3+", ";}return d3;}R2.requiresIContext=true;function S2(i){return i.id;}function T2(i){return i.id;}function U2(j,k){var $2=[];for(var i=0;i<j.length;i++){$2.push(V2(j[i],k));}return $2.join(', ');}function V2(i,j){var k=false;var $2,_2=D.getInstance({'style':'medium'});if(j==='Edm.DateTime'){$2=_2.format(new Date(i.value1));}else if(j==='Edm.DateTimeOffset'){$2=_2.format(new Date(i.value1),true);}else{$2=i.value1;}if(i.operator[0]==="N"){k=true;}if(i.value2){if(j==='Edm.DateTime'){$2+=" - "+_2.format(new Date(i.value1));}else if(j==='Edm.DateTimeOffset'){$2+=" - "+_2.format(new Date(i.value1),true);}else{$2+=" - "+i.value1;}}if(k){$2=b.getText("kpiHeader_Filter_NotOperator",[$2]);}return $2;}function W2(i,j,k){return Y2(i,j,k,"com.sap.vocabularies.Common.v1.Label");}function X2(i,j,k){return Y2(i,j,k,"sap:text");}function Y2(i,j,k,$2){var _2=i.getODataProperty(j,k);if(!_2){q.sap.log.error("No Property Found for with Name '"+k+" For Entity-Type '"+j.name+"'");return;}var a3=_2[$2];if(a3){if($2==="com.sap.vocabularies.Common.v1.Label"){return a3.String;}return a3;}return _2.name;}function Z2(i){if(!i||!i.Value||!i.Value.Path){return"";}return"{parts: [{path:'"+i.Value.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.KpiValueFormatter'}";}return{NumberFormatFunctions:c,DateFormatFunctions:d,CurrencyFormatFunctions:e,formatFunctions:f,criticalityConstants:g,TextArrangementType:T,getLabelForDataItem:h,colorPaletteForComparisonMicroChart:g1,formatField:V,checkFilterPreference:o1,formatItems:p1,getCardSelections:v1,getCardSorters:w1,getFilters:y1,getPrimitiveValue:B1,getAnnotationLabel:N2,getApplicationName:O2,removeDuplicateDataField:E1,formatUrl:F1,getDataPointsCount:G1,getFirstDataPointValue:H1,getFirstDataFieldName:K1,getSecondDataFieldName:L1,getRequestFields:u1,getThirdDataFieldName:M1,formatDataFieldValueOnIndex:P1,formatDataPointValueOnIndex:Q1,formatDataPointOrField:R1,formatsemanticObjectOfDataFieldGeneric:S1,getLabelForFirstDataPoint:W1,formatImageUrl:X1,formatUnit:Y1,formatObjectNumber:Z1,formatFirstDataPointState:$1,formatFirstDataPointColor:_1,formatSecondDataPointState:a2,formatThirdDataPointState:b2,formatFirstDataPointStateForSmartField:c2,formatKPIHeaderState:e2,isFirstDataPointCriticality:f2,isFirstDataPointCriticalityForTableStatus:g2,getSortedDataFields:w,getSortedDataPoints:x,formatDataFieldValueGeneric:k2,formatDataPointValue:o2,formatDataPointStateGeneric:p2,checkCriticalityGeneric:q2,checkCriticalityGenericForTableStatus:r2,formatDataPointStateForSmartFieldGeneric:s2,hasActions:t2,isFirstDataPointPercentageUnit:u2,resolveEntityTypePath:v2,resolveParameterizedEntitySet:w2,getAssociationObject:x2,semanticObjectOfFirstDataField:z2,semanticObjectOfSecondDataField:A2,isFirstContactAnnotation:C2,getAggregateNumber:D2,KpiValueFormatter:E2,kpiValueCriticality:d2,formThePathForAggregateNumber:F2,formThePathForTrendIcon:G2,formPathForPercentageChange:H2,TargetValueFormatter:I2,formPathForTargetValue:J2,returnPercentageChange:K2,isPresentationVarientPresent:L2,listGroupBy:P2,formTheFilterByString:Q2,formTheFilterByStringNotFromSelVar:R2,formTheIdForFilter:S2,formTheIdForFilterNotFromSelVar:T2,_criticality2state:p,_calculateCriticalityState:u,_calculateTrendDirection:v,_getPropertiesFromBindingString:s1,sortCollectionByImportance:H,checkNavTargetForContactAnno:m2,checkForContactAnnotation:n2,getKPIHeaderAggregateNumber:Z2};},true);
