/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.define(["jquery.sap.global","sap/ui/base/ManagedObject","./NS","./Messages","./getResourceBundle"],function(q,M,N,a,g){"use strict";var b=M.extend(N.getName("NodeHierarchy"),{metadata:{"abstract":true,events:{changed:{},nodeCreated:{parameters:{nodeRef:{type:"any"},nodeId:{type:"string"}}},nodeRemoving:{parameters:{nodeRef:{type:"any"},nodeId:{type:"string"}}},nodeReplaced:{parameters:{ReplacedNodeRef:{type:"any"},ReplacementNodeRef:{type:"any"},ReplacedNodeId:{type:"string"},ReplacementNodeId:{type:"string"}}},nodeUpdated:{parameters:{nodeRef:{type:"any"},nodeId:{type:"string"}}}}}});b.prototype.findNodesById=function(c){if(c.fields.some(function(j){return!j.caseSensitive;})){c=q.extend(true,{},c);c.fields.forEach(function(j){if(!j.caseSensitive){j.value=j.value.toLowerCase();}});}var d=function(p,j,v,k){var m;p=p||"equals";k=k||"";var l=j?v:v.toLowerCase();switch(p){case"equals":m=(l===k);break;case"contains":m=(l.indexOf(k)!==-1);break;case"startsWith":m=(l.indexOf(k)===0);break;default:m=false;q.sap.log.error(g().getText(a.VIT8.summary),a.VIT8.code,"sap.ui.vk.dvl.NodeHierarchy");}return m;};var i=function(l,j){return!l.some(function(v){return j.name===v.name?d(j.predicate,j.caseSensitive,v.value,j.value):false;});};var f=function(c,v){return c.source===v.source&&c.type===v.type&&!c.fields.some(i.bind(undefined,v.fields));};var e=this.findNodesByName();var h=e.filter(function(n){var j=this.createNodeProxy(n);var v=j.getVeIds();this.destroyNodeProxy(j);return v.some(f.bind(undefined,c));}.bind(this));return h;};b.prototype.findNodesByMetadata=function(c){var d=function(m,l,n,v,j,k){if(m.hasOwnProperty(l)){var o=m[l];if(o.hasOwnProperty(n)){var s=o[n];if(!k){s=s.toLowerCase();}return v.some(j.bind(undefined,s));}}return false;};var e=function(m,l){if(m==null){return false;}return m.hasOwnProperty(l);};var f=function(h,i,l,m,v,j,k){var n=this._baseNodeProxyPool.borrowObject();var r=h.filter(function(o){n.init(this,o);var s=n.getNodeMetadata();var t=i(s,l,m,v,j,k);n.reset();return t;}.bind(this));this._baseNodeProxyPool.returnObject(n);return r;};var h=this.findNodesByName(),r=[];if(c===undefined||c===null||q.isEmptyObject(c)){r=h;}else if(c.category!==null&&c.category!==undefined&&c.category!==""){var i,v,p,j,k=!!(c&&c.caseSensitive);if(c.key===undefined||c.key===null){i=e;}else{v=c.value;p=c.predicate||"equals";if(v===undefined||v===null){v="";p="contains";}if(!Array.isArray(v)){v=[v];}if(!k){v=v.map(function(l){return l.toLowerCase();});}switch(p){case"equals":j=function(m,l){return m===l;};break;case"contains":j=function(m,l){return m.indexOf(l)!==-1;};break;case"startsWith":j=function(m,l){return m.indexOf(l)===0;};break;default:q.sap.log.error(g().getText(a.VIT9.summary),a.VIT9.code,"sap.ui.vk.dvl.NodeHierarchy");}i=d;}r=f.bind(this)(h,i,c.category,c.key,v,j,k);}else{q.sap.log.error(g().getText(a.VIT10.summary),a.VIT10.code,"sap.ui.vk.dvl.NodeHierarchy");}return q.sap.unique(r);};b.prototype._appendAncestors=function(n,s){s=s?new Set(s):null;var c=new Set(n);n.forEach(function(e){var f=this.getAncestors(e);f.forEach(function(h){if(s===null||!s.has(h)){c.add(h);}});},this);var d=[];c.forEach(function(e){d.push(e);});return d;};return b;});
