sap.ui.define(["../threejs/SceneBuilder","./CallbackHandler","./RequestCommandGenerator","./SceneStateContext"],function(S,C,R,a){"use strict";var b=function(){this.currentSceneInfo={};this.sceneBuilder=new S();this.contextMap=new Map();this.viewIdSceneIdMap=new Map();this.texturesToUpdate=new Map();this.materialIdsToRequest=new Set();this.materialIdsRequested=new Set();this.geometryIdMaterialIdMap=new Map();this.leaderLineMaterialIdMap=new Map();this.imageNoteMaterialIdMap=new Map();this.thumbnailImageIdAndViewIdSceneIdMap=new Map();this.viewIdAndThumbnailImageIdSceneIdMap=new Map();this.requestCommandGenerator=new R();this.trackIds=new Set();this.sequenceIds=new Set();this.highlightStyleIds=new Set();this.onErrorCallbacks=new C();this.onImageFinishedCallbacks=new C();this.onMaterialFinishedCallbacks=new C();this.onSetGeometryCallbacks=new C();this.onSetSequenceCallbacks=new C();this.onSetTrackCallbacks=new C();this.onViewGroupFinishedCallbacks=new C();this.onViewGroupUpdatedCallbacks=new C();};b.prototype.getContext=function(s){if(!s){return null;}return this.contextMap.get(s);};b.prototype.createContext=function(s,p){var c=new a();Object.assign(c,p);c.sceneId=s;c.requestCommandGenerator.setSceneIdAndContext(s,c);if(c.onActiveCamera){c.onActiveCameraCallbacks.attach(c.onActiveCamera);delete c.onActiveCamera;}if(c.onMeshFinished){c.onMeshFinishedCallbacks.attach(c.onMeshFinished);delete c.onMeshFinished;}if(c.onInitialSceneFinished){c.onInitialSceneFinishedCallbacks.attach(c.onInitialSceneFinished);delete c.onInitialSceneFinished;}if(c.onPartialRetrievalFinished){c.onPartialRetrievalFinishedCallbacks.attach(c.onPartialRetrievalFinished);delete c.onPartialRetrievalFinished;}if(c.onViewPartialRetrievalFinished){c.onViewPartialRetrievalFinishedCallbacks.attach(c.onViewPartialRetrievalFinished);delete c.onViewPartialRetrievalFinished;}if(c.onViewFinished){c.onViewFinishedCallbacks.attach(c.onViewFinished);delete c.onViewFinished;}if(c.onSceneCompleted){c.onSceneCompletedCallbacks.attach(c.onSceneCompleted);delete c.onSceneCompleted;}if(c.onProgressChanged){c.setOnProgressChanged(c.onProgressChanged);delete c.onProgressChanged;}this.contextMap.set(s,c);return c;};b.prototype.sidToObject3D=function(s){var c=this.contextMap.values();var d=c.next();var n=null;while(!d.done){var e=d.value;d=c.next();n=this.sceneBuilder.getNode(s,e.sceneId);if(n){break;}}return n;};b.prototype.object3DToSid=function(o){return this.sceneBuilder.getObjectId(o);};b.prototype.dispose=function(){this.currentSceneInfo=null;this.contextMap=null;this.sceneBuilder.cleanup();this.sceneBuilder=null;this.texturesToUpdate=null;this.materialIdsToRequest=null;this.materialIdsRequested=null;this.geometryIdMaterialIdMap=null;this.thumbnailImageIdAndViewIdSceneIdMap=null;this.viewIdAndThumbnailImageIdSceneIdMap=null;this.trackIds=null;this.sequenceIds=null;this.highlightStyleIds=null;this.onErrorCallbacks=null;this.onMaterialFinishedCallbacks=null;this.onImageFinishedCallbacks=null;this.onSetGeometryCallbacks=null;this.onSetTrackCallbacks=null;this.onSetSequenceCallbacks=null;};b.prototype.cleanup=function(){this.currentSceneInfo={};this.contextMap.clear();this.sceneBuilder.cleanup();this.texturesToUpdate.clear();this.materialIdsToRequest.clear();this.materialIdsRequested.clear();this.geometryIdMaterialIdMap.clear();this.viewIdSceneIdMap.clear();this.thumbnailImageIdAndViewIdSceneIdMap.clear();this.viewIdAndThumbnailImageIdSceneIdMap.clear();this.trackIds.clear();this.sequenceIds.clear();this.highlightStyleIds.clear();this.requestCommandGenerator.clearContent();};return b;});
