sap.ui.define(["./ViewBuilder","./CameraHandler","./TotaraUtils","./TreeHandler"],function(V,C,T,a){"use strict";var b=function(){};b.setViewGroup=function(s,c){if(T.checkError(c)||!c.views){return c;}var r={};s.sceneBuilder.insertViewGroup(c,c.sceneId);var v=new Set();var i=new Set();var d=s.getContext(c.sceneId);if(!d){c.error="setViewGroup error: try to extract view group information for unmatching scene/context "+c.sceneId;return c;}if(!d.currentViewGroupId){d.currentViewGroupId=c.id;}if(d.currentViewGroupId!==c.id){return c;}for(var e=0;e<c.views.length;e++){var f=c.views[e];var g=s.sceneBuilder.getView(f.id,c.sceneId);if(f.thumbnailId!==undefined){f.thumbnailId=f.thumbnailId.toString();var p={};p.viewId=f.id;p.sceneId=c.sceneId;s.thumbnailImageIdAndViewIdSceneIdMap.set(f.thumbnailId,p);var h={};h.thumbnailImageId=f.thumbnailId;h.sceneId=c.sceneId;s.viewIdAndThumbnailImageIdSceneIdMap.set(f.id,h);i.add(f.thumbnailId);}if(g){g.userData.viewInfo.thumbnailId=f.thumbnailId;continue;}d.viewIds.add(f.id);v.add(f.id);s.viewIdSceneIdMap.set(f.id,c.sceneId);}r.context=d;r.viewIdSet=v;r.imageIdSet=i;return r;};b.setView=function(s,v){if(T.checkError(v)){return v;}var r={};if(v.sceneId){var c=s.getContext(v.sceneId);if(!c){v.error="setView error: try to extract view information for unmatching scene/context"+v.sceneId;return v;}r.context=c;var d;if(c.initialViewId===v.viewId){if(v.camera){d=v.camera.id;}r.setTreeResult=a.setTree(s,v);s.viewIdSceneIdMap.set(v.viewId,v.sceneId);}v.id=v.viewId;var p=s.viewIdAndThumbnailImageIdSceneIdMap.get(v.id);if(p&&p.sceneId===v.sceneId){v.thumbnailId=p.thumbnailImageId;s.viewIdAndThumbnailImageIdSceneIdMap.delete(v.id);}s.sceneBuilder.insertView(v,v.sceneId);var e=[];c.viewIdTreeNodesMap.set(v.viewId,e);if(v.camera){if(d){v.camera.id=d;}C.setCameraSingle(s,v.camera,v.sceneId);s.sceneBuilder.setViewCamera(v.camera.id,v.id,v.sceneId);}}else{r.error="setView: no sceneId";}return r;};b.setViewNode=function(s,c){if(T.checkError(c)){return c;}var r={};if(c.sceneId){var d=s.getContext(c.sceneId);if(!d){c.error="setViewNode error: try to extract view node information for unmatching scene/context"+c.sceneId;return c;}r.context=d;if(d.initialViewId===c.viewId){r.setTreeNodeResult=a.setTreeNode(s,c);}var v=s.sceneBuilder.getView(c.viewId,c.sceneId);if(!v){r.error="setViewNode error: setViewNode - no setView was in the chain";return r;}if(d.initialViewId===c.viewId){d.initialView=v;}var t=d.viewIdTreeNodesMap.get(c.viewId);t=t.concat(c.nodes);d.viewIdTreeNodesMap.set(c.viewId,t);}else{r.error="setViewNode error: no sceneId";}return r;};b.notifyFinishedView=function(s,c){var r={};if(c.sceneId){var d=s.getContext(c.sceneId);if(!d){c.error="notifyFinishedView error: try to notify finished view for unmatching scene/context";return c;}r.context=d;if(d.initialViewId===c.viewId){r.notifyFinishedTreeResult=a.notifyFinishedTree(s,c);d.initialViewId=null;}var v=s.sceneBuilder.getView(c.viewId,c.sceneId);if(!v){r.error="notifyFinishedView error: setViewNode - no setView was in the chain";return r;}if(v.activeCameraId!==undefined){v.camera=s.sceneBuilder.getCamera(v.activeCameraId);}d.updatedNodes.clear();var e=V.buildView(c.viewId,s,d);s.sceneBuilder.setViewNodeInfos(e.nodeInfos,c.viewId,c.sceneId);r.view=v;r.viewId=c.viewId;r.sceneId=c.sceneId;}else{r.error="notifyFinishedView error: no sceneId";}return r;};return b;});
